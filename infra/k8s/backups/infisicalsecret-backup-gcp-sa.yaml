apiVersion: secrets.infisical.com/v1alpha1
kind: InfisicalSecret
metadata:
  name: virtuasoc-backup-gcp-sa
  namespace: virtuasoc
spec:
  hostAPI: https://app.infisical.com/api
  resyncInterval: 3600

  authentication:
    universalAuth:
      credentialsRef:
        # Reuse the same Machine Identity as the main app secret sync
        secretName: infisical-universal-auth
        secretNamespace: virtuasoc
      secretsScope:
        projectSlug: "<INFISICAL_PROJECT_SLUG>"
        envSlug: "<INFISICAL_ENV_SLUG>"
        # Recommended: store the backup creds under a separate folder/path
        secretsPath: "/backups"

  # Creates/updates a K8s Secret used by the pg_dump â†’ GCS CronJob.
  managedKubeSecretReferences:
    - secretName: virtuasoc-backup-gcp-sa
      secretNamespace: virtuasoc
      creationPolicy: Owner


