# Core runtime
NODE_ENV=development

# Kubernetes ingress prefix (Helm sets /api)
API_BASE_PATH=/api

# Queues
REDIS_URL=

# Control-plane DB (tenant registry)
CONTROL_DATABASE_URL=

# Tenant provisioning (DB-per-tenant)
POSTGRES_ADMIN_URL=
TENANT_DSN_ENCRYPTION_KEY=

# Admin control-plane access (for /admin/* onboarding)
PLATFORM_ADMIN_KEY=

# Auth
# oidc (recommended) | local (dev/break-glass)
AUTH_MODE=oidc
JWT_SECRET=

# Distribution
TEAMS_WEBHOOK_URL=
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=
SMTP_FROM=

# Policies
DISTRIBUTION_REQUIRE_APPROVAL=true
REDACT_PII_ON_DISTRIBUTION=true
DATA_RETENTION_DAYS=90

# Worker
RSS_FEED_URLS=
TENANT_SLUGS=
REPORT_DEFINITIONS_DIR=

# LLM
LLM_PROVIDER=mock
AZURE_OPENAI_ENDPOINT=
AZURE_OPENAI_API_KEY=
AZURE_OPENAI_DEPLOYMENT=
AZURE_OPENAI_API_VERSION=2024-06-01
OPENAI_API_KEY=
OPENAI_MODEL=gpt-5.2
# Optional override (defaults to https://api.openai.com/v1)
OPENAI_BASE_URL=
ANTHROPIC_API_KEY=
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022

# Shared
NODE_ENV=development

# API/Worker database
DATABASE_URL=postgres://virtuasoc:virtuasoc@localhost:5432/virtuasoc

# SaaS control-plane database (tenant registry). If unset, API may fall back to DATABASE_URL in dev.
CONTROL_DATABASE_URL=

# Postgres admin connection for tenant DB provisioning (needs CREATE DATABASE/ROLE privileges)
POSTGRES_ADMIN_URL=

# Required for DB-per-tenant: 32-byte key (base64 or hex) used to encrypt tenant DB DSNs at rest
TENANT_DSN_ENCRYPTION_KEY=

# Optional: platform admin API key for tenant onboarding endpoints (/admin/*)
PLATFORM_ADMIN_KEY=

# Redis (queues)
REDIS_URL=redis://localhost:6379

# Auth
AUTH_MODE=oidc
JWT_SECRET=change-me-in-dev
DEFAULT_TENANT_NAME=AcmeCorp
SEED_ADMIN_EMAIL=admin@virtuasoc.local
SEED_ADMIN_PASSWORD=admin

# API
PORT=3001
API_BASE_PATH=

# Worker
# Comma-separated RSS feeds (leave empty to use built-in gov advisory defaults)
RSS_FEED_URLS=
# Optional: limit worker processing to a subset of tenants by slug (comma-separated)
TENANT_SLUGS=
# Optional: load report definitions from a directory (JSON files). If unset, defaults to repo `packages/reporting/report_definitions/mvp`.
REPORT_DEFINITIONS_DIR=
# Retention controls
DATA_RETENTION_DAYS=90

# LLM Providers
# Use "mock" for local/dev without keys, or set to: azure_openai | openai | anthropic
LLM_PROVIDER=mock

# Azure OpenAI
AZURE_OPENAI_ENDPOINT=
AZURE_OPENAI_API_KEY=
AZURE_OPENAI_DEPLOYMENT=
AZURE_OPENAI_API_VERSION=2024-06-01

# OpenAI
OPENAI_API_KEY=
OPENAI_MODEL=gpt-5.2
# Optional override (defaults to https://api.openai.com/v1)
OPENAI_BASE_URL=

# Anthropic
ANTHROPIC_API_KEY=
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022

# Distribution integrations
TEAMS_WEBHOOK_URL=
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=
SMTP_FROM=
DEFAULT_WEBHOOK_TARGET=

# Distribution policy
# Set to "false" to allow queueing distribution before approval (not recommended).
DISTRIBUTION_REQUIRE_APPROVAL=true
# Redact common PII patterns (email/phone/SSN) on outbound distribution
REDACT_PII_ON_DISTRIBUTION=true
# For product webhooks: include PDF bytes inline (base64). Keep false unless required.
WEBHOOK_INCLUDE_PDF_BASE64=false

# Chromium executable path (worker PDF rendering via puppeteer-core)
# Leave empty in k8s/docker (the worker image installs chromium and auto-detects paths).
# For local dev on Windows/macOS, set this to your Chrome/Chromium executable path.
CHROMIUM_PATH=

# AI Setup Assistant (tenant + platform admin)
AI_SETUP_ENABLED=false
AI_SETUP_MAX_TOOL_CALLS=5
AI_SETUP_MAX_OUTPUT_TOKENS=600
AI_SETUP_MAX_REQUESTS_PER_TENANT_PER_DAY=50

# Factory app (Next.js) feature flags
FEATURE_FACTORY_APP=false
FEATURE_RBAC=false
FEATURE_EVIDENCE_INGEST=false
FEATURE_ENTITY_LINKING=false
FEATURE_SIGNALS=false
FEATURE_PRODUCT_FACTORY=false
FEATURE_REVIEW_DISTRIBUTION=false

# Factory app (NextAuth + Entra)
NEXTAUTH_URL=
NEXTAUTH_SECRET=
ENTRA_CLIENT_ID=
ENTRA_CLIENT_SECRET=
ENTRA_TENANT_ID=

# Prisma tenant DB URL (used for tenant schema migrations in dev/CI)
TENANT_DATABASE_URL=


